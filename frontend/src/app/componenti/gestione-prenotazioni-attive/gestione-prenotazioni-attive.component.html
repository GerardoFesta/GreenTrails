<div class="container">
  <div class="titolo">
    <h1>I miei viaggi</h1>
  </div>
  <div class="dettagli">
    <div class="seleziona">
      <section class="example-section">
        <mat-checkbox  [(ngModel)]="mostraSoloInCorso" (change)="updateTable()" class="example-margin" color="primary">
          Mostra solo in corso
        </mat-checkbox>
      </section>
    </div>
    <!-- <div class="ricerca">
      <div class="input" style="height: 50%;">
        <input type="search" id="site-search" name="q" style="border-radius: 10%" [(ngModel)]="searchQuery" />
        <button (click)="search()">Search</button>
      </div>
    </div> -->
  </div>

  <div class="attivita" #tableContainer (scroll)="onScroll($event)">
   <!-- Utilizza MatTable per creare la tabella -->
<table mat-table [dataSource]="dataSource" class="table">
  <!-- stato column -->
  <ng-container matColumnDef="stato">
    <th mat-header-cell *matHeaderCellDef style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> Stato </th>
    <td mat-cell *matCellDef="let prenotazione">{{ formatStato(prenotazione.stato) }}</td>
  </ng-container>
  <!-- Nome column -->
  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> ID </th>
    <td mat-cell *matCellDef="let prenotazione">{{ prenotazione.id }}</td>
  </ng-container>
  <!-- Check-in column -->
  <ng-container matColumnDef="check-in">
    <th mat-header-cell *matHeaderCellDef style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> Check-in </th>
    <td mat-cell *matCellDef="let prenotazione"><mat-icon style="color: lightgreen;">event</mat-icon>{{ prenotazione.checkIn }}</td>
  </ng-container>
  <!-- Check-out column -->
  <ng-container matColumnDef="check-out">
    <th mat-header-cell *matHeaderCellDef style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> Check-out </th>
    <td mat-cell *matCellDef="let prenotazione"><mat-icon style="color: lightgreen;">event</mat-icon>
      {{ prenotazione.checkOut  }}</td>
  </ng-container>
  <!-- Bambini column -->
  <ng-container matColumnDef="bambini">
    <th mat-header-cell *matHeaderCellDef style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> Bambini </th>
    <td mat-cell *matCellDef="let prenotazione"><mat-icon style="color: lightgreen;">child_care</mat-icon>{{ prenotazione.bambini }}</td>
  </ng-container>
  <!-- Adulti column -->
  <ng-container matColumnDef="adulti">
    <th mat-header-cell *matHeaderCellDef style="color:rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> Adulti </th>
    <td mat-cell *matCellDef="let prenotazione"><mat-icon style="color: lightgreen;">person</mat-icon>{{ prenotazione.adulti }}</td>
  </ng-container>
  <!-- Prezzo column -->
  <ng-container matColumnDef="prezzo">
    <th mat-header-cell *matHeaderCellDef style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"> Prezzo </th>
    <td mat-cell *matCellDef="let prenotazione">{{ prenotazione.prezzo | currency:'EUR':'symbol':'1.2-2' }}</td>
  </ng-container>
  <!-- Actions column -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef style="color:rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle; font-weight: bold;"></th>
    <td mat-cell *matCellDef="let prenotazione">
      
      <button mat-icon-button color="primary" (click)="openPopup(prenotazione)">
        <mat-icon>menu_book</mat-icon>
      </button>
      <button mat-icon-button color="warn" *ngIf="prenotazione.stato === 'IN_CORSO' && prenotazione.tipo === 'alloggio'" (click)="onDeletePrenotazioneAlloggio(prenotazione.id, prenotazione.stato)">
        <mat-icon>delete</mat-icon>
      </button>
      
      <button mat-icon-button color="warn" *ngIf="prenotazione.stato === 'IN_CORSO' && prenotazione.tipo === 'attivita'" (click)="onDeletePrenotazioneAttivita(prenotazione.id, prenotazione.stato)">
        <mat-icon>delete</mat-icon>
      </button>
    </td>
  </ng-container>
  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;" style="color: rgb(10, 34, 1); background-color: #32CD32; vertical-align: middle;"></tr>
</table>

    <mat-paginator
    [length]="dataSource.data.length"
    [pageSize]="pageSize"
    [pageSizeOptions]="[10, 25, 50, 100]"
    (page)="updatePaginatedData()"
    aria-label="Select page; color: white;"
    [pageSizeOptions]="[5, 10, 25, 100]"
    showFirstLastButtons
    style="color: rgb(10, 34, 1); background-color: #32CD32; border-radius: 5%;"
  ></mat-paginator>
  </div>
</div>
